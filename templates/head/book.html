{% extends 'base.html' %}
{% load nepali %}
{% load datefilters %}

{% block content %}
<div class="container-fluid">
  {% if book.is_borrowed == True %}
  <div class="alert alert-danger">
    <strong>Oh, No!</strong> This book with accession number <span class="label label-primary">{{ book.accession_number }}</span> was borrowed by <a href="{% url 'profile' username=user.username %}">{{ book.get_borrower.get_name }}</a> {{ days_ago }} ({{ lends.lending_date }}).
  </div>
  {% elif book.is_discarded %}
  <div class="alert alert-danger">
    <strong>Oh, No!</strong> This book with accession number <span class="label label-primary">{{ book.accession_number }}</span> has been discarded!
  </div>
  {% else %}
  <div class="alert alert-success">
    <strong>Yay!</strong> This book is available on shelf <span class="label label-primary">{{ book.call_number }}</span>
  </div>
  {% endif %}

  {% if book.is_discarded == False and user.is_authenticated == True %}
  <div class="text-warning btn-group">
    <a class="btn btn-warning" href="{% url 'delete_book_confirm' book.get_accession_number %}">
      <span class="glyphicon glyphicon-remove"></span> Discard Book
    </a>
    <a class="btn btn-info" href="{% url 'editEntry' acc_no=book.get_accession_number %}">
      <span class="glyphicon glyphicon-edit"></span> Edit Book
    </a>
  </div>
  {% endif %}
  <h3>
    <div>
      <span class="text-info">
        {% if book.get_authors != "" %}{{ book.get_authors|title }} को {% endif %}
      </span>
      <i>
        <span class="text-primary">
          {{ book.title|title }}
        </span>
      </i>
    </div>
  </h3>
  <table class="table table-hover table-responsive">
    {% for each in book.get_all_attr %}
    <tr> 
      <td>{{ each.0|title|nepali }}</td>
      {% if each.0 == "Author" %}
      <td><a href="/search/book/?type={{ globals.text.author }}&search={{each.1}}">{{ each.1|title }}</a></td>
      {% else %}
      <td >{{each.1|title|no_to_np}}</td>
      {% endif %}
    </tr>
    {% endfor %}
    <tr>
      <td>{{globals.text.is_book_available }}</td>
      <td>
	{% if book.is_borrowed == False %}
  <span class="text-success"><b>{{globals.text.yes}}</b></span>
	{% else %}
  <span class="text-danger"><b>{{globals.text.no}}</b></span>
	{% endif %}
      </td>
    </tr>
    <tr>
      <td>
	Is there any late fees?
      </td>
      <td>
	{% if book.is_borrowed == False %}
  <span class="text-success"> <b>{{globals.text.no}}</b>, the book isn't borrowed</span>
	{% elif late_fees != 0 %}
  <span class="text-warning"><b>{{globals.text.yes}}</b>, late fees :<i> Rs.{{ late_fees|no_to_np }}</i></span>
	{% elif late_fees == 0 %}
  <span class="text-success"><b>{{globals.text.no}}</b></span>
	{% endif %}
      </td>
    </tr>
  </table>
  </font>
</div>
{% endblock %}
